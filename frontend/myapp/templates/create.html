{% extends "base.html" %}
{% block title %}Create Page{% endblock %}
{% block homeActive %}"nav-item"{% endblock %}
{% block createActive %}"nav-item active"{% endblock %}
{% block contactActive %}"nav-item"{% endblock %}
{% block content %}

<div>
  <p>This is our create page</p>
  <p>Here you can choose from a variety of options to create different videos</p>
</div>

<form>
  <label for="dropdown1">Content:</label>
  <select id="dropdown1" name="dropdown1">
    <option value="AITAH">r/AITAH</option>
    <option value="TIFU">r/TIFU</option>
    <option value="News">News</option>
  </select>

  <br />

  <label for="dropdown2">Video:</label>
  <select id="dropdown2" name="dropdown2">
    <option value="Subway Surfers">Subway Surfers</option>
    <option value="Generated Images">Generated Images</option>
    <option value="Minecraft Parkour">Minecraft Parkour</option>
  </select>

  <br />

  <form action="/content/" method="post">
    <label for="content">Choose content: </label>
    <input id="content" type="text" name="content" value="{{ current_name }}" />
    <input type="submit" value="OK" />
  </form>

  <button type="button" onclick="submitFormAndShowLoadingCircle()">
    Submit
  </button>
  <div id="loading-circle" style="display: none">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>
  <div id="loading-text" style="display: none">
    Loading...
  </div>

  <br />
  <br />
  <center>
    Search Employees using Dropdown Search
    <hr />
    <form method="POST">
      {% csrf_token %}
      <select name="gender">
        <option selected disabled="true">Select Content</option>
        <option>r/AITAH</option>
        <option>r/TIFU</option>
        <option>Other</option>
      </select>
      <select name="designation">
        <option selected disabled="true">Select Video</option>
        <option>Subway Surfers</option>
        <option>Generated Images</option>
        <option>Minecraft</option>
      </select>
      <input type="submit" value="Search" />
      <hr />
      <table border="1">
        <tr>
          <th>Employee ID</th>
          <th>Name</th>
          <th>Gender</th>
          <th>Designation</th>
        </tr>
        {% for result in data %}
        <tr>
          <td>{{result.emp_id}}</td>
          <td>{{result.name}}</td>
          <td>{{result.gender}}</td>
          <td>{{result.designation}}</td>
        </tr>
        {% endfor %}
      </table>
    </form>
  </center>
</form>

<script>
    function submitFormAndShowLoadingCircle() {
      // Get selected values from dropdowns
      var dropdown1Value = document.getElementById("dropdown1").value;
      var dropdown2Value = document.getElementById("dropdown2").value;
  
      // Show the loading circle
      document.getElementById("loading-circle").style.display = "block";
  
      // Make an AJAX request to execute_dummy endpoint with parameters
      fetch(`/execute_dummy/?dropdown1=${dropdown1Value}&dropdown2=${dropdown2Value}`)
        .then(function(response) {
          return response.json();
        })
        .then(function(data) {
          // Handle the response data
          console.log('Result:', data.result);
          document.getElementById("loading-text").innerText = data.result;
          document.getElementById("loading-text").style.display = "block";
          document.getElementById("loading-circle").style.display = "none";
          // You can update the page or handle the result as needed
        })
        .catch(function(error) {
          console.error('Error:', error);
          document.getElementById("loading-text").innerText = "Error";
          document.getElementById("loading-text").style.display = "block";
          document.getElementById("loading-circle").style.display = "none";
        });
  
      // Submit the form
      //document.querySelector("form").submit();
    }
  </script>

{% endblock %}